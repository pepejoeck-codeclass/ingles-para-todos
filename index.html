<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>InglÃ©s Para Todos - Premium</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  
  <style>
    /* Estilos extra para las nuevas funciones */
    .locked { opacity: 0.5; pointer-events: none; cursor: not-allowed; }
    .nav-link { cursor: pointer; }
    .medal-icon { font-size: 2em; margin: 0 5px; }
  </style>
</head>
<body>

<header>
  <h1>InglÃ©s Para Todos</h1>
  <div class="header-buttons">
    <button type="button" id="themeToggle">ğŸŒ™ / â˜€ï¸</button>
    <button type="button" id="hamburger" class="hamburger">â˜°</button>
  </div>
  
  <div style="margin-top: 10px;">
      <button type="button" id="logoutBtn" style="display:none;">ğŸšª Cerrar SesiÃ³n</button>
      <button type="button" id="openTeacherBtn">ğŸ‘¨â€ğŸ« Modo Maestro</button>
  </div>

  <nav id="nav">
    <a class="nav-link" id="navL1" onclick="window.selectLevel(1)">LecciÃ³n 1 (BÃ¡sicos)</a>
    <a class="nav-link locked" id="navL2" onclick="window.selectLevel(2)">LecciÃ³n 2 (Animales) ğŸ”’</a>
    <a class="nav-link locked" id="navL3" onclick="window.selectLevel(3)">LecciÃ³n 3 (Colores) ğŸ”’</a>
    <a href="#">Juegos</a>
  </nav>
</header>

<section class="card" id="loginCard">
  <h2>ğŸ‘¤ Iniciar sesiÃ³n / Registro</h2>
  <p style="font-size: 0.9em; color: #666;">Si es tu primera vez, escribe tus datos y se crearÃ¡ tu cuenta automÃ¡ticamente.</p>
  
  <input type="text" id="gradeInput" placeholder="Grado (ej. 1)" />
  <input type="text" id="groupInput" placeholder="Grupo (ej. A)" />
  <input type="text" id="usernameInput" placeholder="Nombre completo" />
  
  <p>â€” Datos de acceso â€”</p>
  <input type="email" id="emailInput" placeholder="Correo electrÃ³nico (Gmail)" />
  <input type="password" id="passwordInput" placeholder="ContraseÃ±a (MÃ­nimo 6 caracteres)" />

  <button type="button" id="loginBtn">Entrar / Registrarse</button>

  <p style="text-align: center; margin-top: 15px;">
    <a href="#" id="forgotPasswordLink" style="color: #666; font-size: 0.9em; text-decoration: underline;">
       Forgot your password? / Â¿Olvidaste tu contraseÃ±a?
    </a>
  </p>
</section>

<section class="card" id="teacherLogin" style="display:none;">
  <h2>ğŸ‘¨â€ğŸ« Acceso Maestro</h2>
  <input type="text" id="teacherUser" placeholder="Usuario">
  <input type="password" id="teacherPass" placeholder="ContraseÃ±a">
  <button type="button" id="teacherLoginBtn">Entrar</button>
  <button type="button" id="closeTeacherLogin">Cancelar</button>
</section>

<main id="mainContent" style="display:none;">
  <h3 id="userDisplay"></h3>
  
  <div style="width: 100%; background-color: #ddd; border-radius: 10px; margin-bottom: 10px;">
      <div id="lessonProgressBar" style="width: 0%; height: 10px; background-color: #4CAF50; border-radius: 10px; transition: width 0.5s;"></div>
  </div>
  <p style="text-align:center; font-size:0.8em;">Progreso de lecciÃ³n: <span id="progressText">0/5</span></p>

  <section class="card">
    <h2 id="questionText">Pulsa para comenzar</h2>
    <p id="feedback" style="font-weight: bold; height: 20px;"></p>
    <input type="text" id="answerInput" placeholder="Respuesta..." autocomplete="off" />
    <div style="margin-top:10px;">
        <button type="button" id="startGame">Nueva Pregunta</button>
        <button type="button" id="checkAnswer">Responder</button>
    </div>
    <hr>
    <p id="starsText">â­ Estrellas: 0</p>
    <p id="timeText">â± Tiempo: 0 min 0 s</p>
  </section>
  <section class="card">
    <p id="scoreText">0 puntos</p>
    <p id="levelText">Nivel Actual: 1</p>
  </section>
</main>

<section id="teacherPanel" class="card" style="display:none;">
  <h2>ğŸ‘¨â€ğŸ« Panel Maestro (Nube)</h2>
  <div style="margin-bottom: 15px;">
      <label>Filtrar por Grupo:</label>
      <select id="groupSelect"><option value="">Todos los grupos</option></select>
      <button type="button" id="refreshTeacher">ğŸ”„ Actualizar</button>
      <button type="button" id="exportBtn" style="background-color: #28a745; color: white;">ğŸ“¥ Excel</button>
      <button type="button" id="viewStatsBtn" style="background-color: #673ab7; color: white;">ğŸ“Š Ver GrÃ¡ficas y Reporte</button>
      <button type="button" id="resetMonthlyBtn" style="background-color: #f44336; color: white;">ğŸ—“ï¸ Reiniciar TODOS</button>
  </div>
  <div style="overflow-x: auto;">
      <table border="1" width="100%" style="border-collapse: collapse; text-align: center;">
        <thead>
          <tr style="background-color: #eee;">
            <th>Alumno</th><th>Grado</th><th>Grupo</th><th>Puntos</th><th>Nivel</th><th>Medallas</th><th>Acciones</th>
          </tr>
        </thead>
        <tbody id="studentsTable"></tbody>
      </table>
  </div>
  <br>
  <button type="button" id="closeTeacherPanel">Cerrar SesiÃ³n Maestro</button>
</section>

<div id="statsModal" style="display:none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.9); z-index: 9999; overflow-y: auto;">
    <div style="background: white; margin: 2% auto; padding: 20px; width: 90%; max-width: 800px; border-radius: 10px;">
        <div style="display:flex; justify-content:space-between;">
            <h2>ğŸ“Š Reporte de Progreso</h2>
            <button onclick="document.getElementById('statsModal').style.display='none'" style="background:red; color:white;">X</button>
        </div>
        <button id="downloadPdfBtn" style="background: #007bff; color: white; margin-bottom:10px;">ğŸ–¨ï¸ Descargar PDF</button>
        
        <div id="reportContent">
            <h3>Rendimiento del Grupo</h3>
            <canvas id="groupChart" height="100"></canvas>
            
            <h3>ğŸ† Historial Reciente de Medallas</h3>
            <ul id="historyList" style="list-style: none; padding: 0;"></ul>
        </div>
    </div>
</div>

<script type="module" src="js/app.js"></script>
</body>
</html>
