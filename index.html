<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>InglÃ©s Para Todos - Pro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/styles.css">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  
  <style>
    /* Estilos para el bloqueo y mejoras visuales */
    .locked { opacity: 0.6; pointer-events: none; filter: grayscale(100%); }
    .nav-link { cursor: pointer; user-select: none; }
    .fa-lock { margin-left: 5px; color: #d9534f; }
    .fa-unlock { margin-left: 5px; color: #5cb85c; }
    
    /* Botones de acciÃ³n en tabla maestro */
    .action-btn { border: none; padding: 5px 8px; margin: 0 2px; border-radius: 4px; cursor: pointer; color: white; transition: 0.3s; }
    .btn-group { background-color: #f0ad4e; } /* Naranja */
    .btn-reset { background-color: #0275d8; } /* Azul */
    .btn-delete { background-color: #d9534f; } /* Rojo */
    .action-btn:hover { opacity: 0.8; transform: scale(1.05); }
  </style>
</head>
<body>

<header>
  <h1>InglÃ©s Para Todos</h1>
  <div class="header-buttons">
    <button type="button" id="themeToggle" title="Cambiar Tema">ğŸŒ™ / â˜€ï¸</button>
    <button type="button" id="hamburger" class="hamburger">â˜°</button>
  </div>
  
  <div style="margin-top: 10px;">
      <button type="button" id="logoutBtn" style="display:none;">ğŸšª Cerrar SesiÃ³n</button>
      <button type="button" id="openTeacherBtn">ğŸ‘¨â€ğŸ« Modo Maestro</button>
  </div>

  <nav id="nav">
    <a class="nav-link" id="navL1" onclick="window.selectLevel(1)">LecciÃ³n 1 (BÃ¡sicos)</a>
    <a class="nav-link locked" id="navL2" onclick="window.selectLevel(2)">LecciÃ³n 2 (Animales) <i class="fas fa-lock"></i></a>
    <a class="nav-link locked" id="navL3" onclick="window.selectLevel(3)">LecciÃ³n 3 (Colores) <i class="fas fa-lock"></i></a>
    <a href="#">Juegos</a>
  </nav>
</header>

<section class="card" id="loginCard">
  <h2>ğŸ‘¤ Iniciar sesiÃ³n / Registro</h2>
  <p style="font-size: 0.9em; color: #666;">Ingresa tus datos. Si eres nuevo, tu cuenta se crearÃ¡ automÃ¡ticamente.</p>
  
  <input type="text" id="gradeInput" placeholder="Grado (ej. 1)" />
  <input type="text" id="groupInput" placeholder="Grupo (ej. A)" />
  <input type="text" id="usernameInput" placeholder="Nombre completo" />
  
  <p style="margin: 10px 0; font-weight:bold;">â€” Datos de Acceso â€”</p>
  <input type="email" id="emailInput" placeholder="Correo electrÃ³nico (Gmail)" />
  <input type="password" id="passwordInput" placeholder="ContraseÃ±a (MÃ­nimo 6 caracteres)" />

  <button type="button" id="loginBtn">Entrar / Registrarse</button>

  <p style="text-align: center; margin-top: 15px;">
    <a href="#" id="forgotPasswordLink" style="color: #666; font-size: 0.9em; text-decoration: underline;">
       Forgot your password? / Â¿Olvidaste tu contraseÃ±a?
    </a>
  </p>
</section>

<section class="card" id="teacherLogin" style="display:none;">
  <h2>ğŸ‘¨â€ğŸ« Acceso Maestro</h2>
  <input type="text" id="teacherUser" placeholder="Usuario">
  <input type="password" id="teacherPass" placeholder="ContraseÃ±a">
  <button type="button" id="teacherLoginBtn">Entrar</button>
  <button type="button" id="closeTeacherLogin" style="background-color: #777;">Cancelar</button>
</section>

<main id="mainContent" style="display:none;">
  <h3 id="userDisplay"></h3>
  
  <div style="width: 100%; background-color: #e0e0e0; border-radius: 10px; margin-bottom: 10px; overflow: hidden;">
      <div id="lessonProgressBar" style="width: 0%; height: 12px; background-color: #4CAF50; transition: width 0.5s;"></div>
  </div>
  <p style="text-align:center; font-size:0.8em; color:#666;">Progreso de lecciÃ³n: <span id="progressText">0/5</span></p>

  <section class="card">
    <h2 id="questionText">Cargando...</h2>
    <p id="feedback" style="font-weight: bold; height: 25px; margin-bottom:5px;"></p>
    
    <input type="text" id="answerInput" placeholder="Escribe tu respuesta..." autocomplete="off" />
    
    <div style="margin-top:15px; display:flex; gap:10px; justify-content:center;">
        <button type="button" id="startGame" style="background:#17a2b8;">ğŸ”„ Otra</button>
        <button type="button" id="checkAnswer" style="background:#28a745;">âœ… Responder</button>
    </div>
    
    <hr>
    <div style="display:flex; justify-content:space-around; font-size:0.9em;">
        <p id="starsText">â­ Estrellas: 0</p>
        <p id="timeText">â± 0m 0s</p>
    </div>
  </section>

  <section class="card">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <div>
            <p id="scoreText" style="font-size:1.2em; font-weight:bold;">0 pts</p>
            <p id="levelText" style="color:#666;">Nivel 1</p>
        </div>
        <div id="miniMedals" style="font-size:1.5em;"></div>
    </div>
  </section>
</main>

<section id="teacherPanel" class="card" style="display:none; max-width: 95%;">
  <div style="display:flex; justify-content:space-between; align-items:center;">
      <h2>ğŸ‘¨â€ğŸ« Panel de Control</h2>
      <button type="button" id="closeTeacherPanel" style="background:transparent; color:#333; font-size:1.5em; padding:0;">âœ–</button>
  </div>

  <div style="margin-bottom: 15px; background:#f9f9f9; padding:10px; border-radius:8px;">
      <label><b>Filtrar:</b></label>
      <select id="groupSelect" style="padding:5px;"><option value="">Todos los grupos</option></select>
      
      <div style="margin-top:10px; display:flex; gap:5px; flex-wrap:wrap;">
          <button type="button" id="refreshTeacher">ğŸ”„ Actualizar</button>
          <button type="button" id="viewStatsBtn" style="background-color: #6f42c1; color: white;">ğŸ“Š Reporte GrÃ¡fico</button>
          <button type="button" id="resetMonthlyBtn" style="background-color: #d9534f; color: white;">âš  Reiniciar ESCUELA</button>
      </div>
  </div>

  <div style="overflow-x: auto;">
      <table border="1" width="100%" style="border-collapse: collapse; text-align: center; font-size:0.9em;">
        <thead>
          <tr style="background-color: #333; color:white;">
            <th>Alumno</th>
            <th>Gpo</th>
            <th>Pts</th>
            <th>Nivel</th>
            <th>ğŸ¥‡/ğŸ¥ˆ/ğŸ¥‰</th>
            <th style="min-width:120px;">Acciones</th>
          </tr>
        </thead>
        <tbody id="studentsTable"></tbody>
      </table>
  </div>
</section>

<div id="statsModal" style="display:none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.8); z-index: 10000; overflow-y: auto;">
    <div style="background: white; margin: 5% auto; padding: 25px; width: 90%; max-width: 800px; border-radius: 10px; position:relative;">
        <button onclick="document.getElementById('statsModal').style.display='none'" style="position:absolute; top:10px; right:10px; background:red; color:white; border:none; padding:5px 10px; border-radius:50%;">X</button>
        
        <h2>ğŸ“Š Reporte de Rendimiento Escolar</h2>
        <button id="downloadPdfBtn" style="background: #007bff; color: white; margin-bottom:15px;">ğŸ–¨ï¸ Descargar PDF</button>
        
        <div id="reportContent">
            <div style="text-align:center; margin-bottom:20px;">
                <h3>Resumen de Medallas (Global)</h3>
                <canvas id="groupChart" style="max-height:300px;"></canvas>
            </div>
            <hr>
            <h3>ğŸ“œ Historial Reciente de Logros</h3>
            <ul id="historyList" style="list-style: none; padding: 0; font-size:0.9em;"></ul>
        </div>
    </div>
</div>

<script type="module" src="js/app.js"></script>
</body>
</html>
